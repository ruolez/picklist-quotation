<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ffffff">
    <title>Dashboard - Picklist Converter</title>
    <link rel="stylesheet" href="/static/css/style.css?v=20251113-THEME">
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-to-main">Skip to main content</a>

    <!-- Header with Dark Mode Toggle -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <h1>Picklist to Quotation Converter</h1>
                <nav class="nav-links">
                    <a href="/" class="nav-link active">Picklists</a>
                    <a href="/history" class="nav-link">History</a>
                    <a href="/settings" class="nav-link">Settings</a>
                </nav>
            </div>
            <div class="header-right">
                <!-- Theme Toggle Button -->
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <div class="theme-toggle-slider"></div>
                </button>
            </div>
        </div>
    </header>

    <main id="main-content" class="container">
        <h1 class="mb-3">Dashboard</h1>

        <!-- Statistics -->
        <div class="history-stats">
            <div class="stat-card">
                <div class="stat-label">Total Converted</div>
                <div class="stat-value" id="stat-converted">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Pending Picklists</div>
                <div class="stat-value" id="stat-pending">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Success Rate</div>
                <div class="stat-value" id="stat-success-rate">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Failed Conversions</div>
                <div class="stat-value" id="stat-failed">-</div>
            </div>
        </div>

        <!-- Polling Status -->
        <div class="card">
            <h2 class="card-title">Polling Service</h2>
            <div class="status-indicator stopped" id="poller-status">
                <span class="status-dot"></span>
                <span>Stopped</span>
            </div>
            <div class="btn-group" style="margin-top: 20px;">
                <button id="btn-start-poller" class="btn btn-primary" aria-label="Start automatic polling">Start Auto-Polling</button>
                <button id="btn-stop-poller" class="btn btn-error" aria-label="Stop automatic polling">Stop Auto-Polling</button>
            </div>
        </div>

        <!-- Manual Conversion -->
        <div class="card">
            <h2 class="card-title">Manual Conversion</h2>
            <p class="card-description">
                Click the button below to manually check for new picklists and convert them to quotations.
            </p>
            <button id="btn-convert" class="btn btn-primary" aria-label="Convert pending picklists">
                Convert Pending Picklists
            </button>
            <div id="conversion-results" class="mt-2"></div>
        </div>
    </main>

    <!-- Theme and Keyboard Management Scripts -->
    <script src="/static/js/theme.js?v=20251113-THEME"></script>
    <script src="/static/js/keyboard.js?v=20251113-THEME"></script>
    <script src="/static/js/dashboard.js?v=20251113-THEME"></script>

    <!-- Theme Toggle Functionality -->
    <script>
        // Connect theme toggle button to ThemeManager
        document.getElementById('themeToggle')?.addEventListener('click', () => {
            themeManager.toggle();
        });
    </script>
</body>
</html>
